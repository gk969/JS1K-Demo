<html>	<head>		<title>JS1K Demo</title>		<meta charset="utf-8">	</head>		<body>		<canvas id="c" width="700" height="600" style="background-color: rgb(0, 0, 0); background-position: initial initial; background-repeat: initial initial;"></canvas>		<script>			var b = document.body;			var c = document.getElementsByTagName('canvas')[0];			var a = c.getContext('2d');			document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218		</script>				<script>						// start of submission //			U=W=c.width=700;H=c.height=600;M=Math;c.style.background="#000";R=10032148;S=13;D=0;V=255;P=[];E=[[250,200],[450,200]];F=[[150,350],[550,350],[350,500,600]];onkeypress=function(){P=[];(D=!D)?(S=13,R=1153433,E=[[350,300]],F=[[250,300,100],[450,300,100]]):(S=1,R=3381555,E=[[200,250]],F=[[300,300,140]])};onmousedown=function(){F.push(U=[0,0,-120])};onmouseup=function(){U&&F.splice(F.indexOf(U),1)};onmousemove=function(d){U&&(U[0]=d.offsetX||d.layerX,U[1]=d.offsetY||d.layerY)};g();			function g(){T=[];c.width=W;I=a.getImageData(0,0,W,H);X=I.data;for(i=0;e=E[i++];)for(j=15;j--;)A=M.random()*S,P.push([[e[0],e[1]],[M.cos(A),M.sin(A)]]);for(;p=P.pop();){i=F.length;for(q=p[0];f=F[--i];)x=f[0]-q[0],y=f[1]-q[1],s=f[2]||-30,A=s/M.pow(x*x+s/2+y*y+s/2,1.5),p[1][0]+=x*A,p[1][1]+=y*A;q[0]+=p[1][0];q[1]+=p[1][1];0<q[0]&&q[0]<W&&0<q[1]&&q[1]<H&&(T.push(p),b=4*(~~q[1]*W+~~q[0]),X[b]+=R>>16&V,X[b+1]+=R>>8&V,X[b+2]+=R&V,X[b+3]=V)}a.putImageData(I,0,0);P=T;setTimeout(g,15)};			// end of submission //							</script>			</body></html>	