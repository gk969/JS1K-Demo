<html>	<head>		<title>JS1K Demo</title>		<meta charset="utf-8">	</head>		<body>		<canvas id="c" width="1024" height="768">		<script>			var b = document.body;			var c = document.getElementsByTagName('canvas')[0];			var a = c.getContext('2d');			document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218		</script>				<script>			// line			function A(x,y,z,w,c)			{				with (G) 				{					lineWidth = 4;					strokeStyle = 'rgb(' + F(c[0]*h) + ',' + F(c[1]*h) + ',' + F(c[2]*h) + ')';					beginPath();					moveTo(x, y);					lineTo(z, w);					stroke();				}			}			// sky			function B()			{				a = y / h;				return [.2 + a, .3 + a,.6 + a * .7];			}			// noise			function C(x, y)			{				s = M.log(d + 20) / .7 - 1;				b = s - (s = F(s));				c = q = 0;				for (i = s; i < s + 8; i++)				{					t = E(2, i);					X = x / t;					Y = y / t;					u = X - F(X);					v = Y - F(Y);					X -= u;					Y = (Y - v) * I;					Z = Y + I;					a=[						Y % J + X++ % I,						Y % J + X % I,						Z % J + X-- % I,						Z % J + X % I					];					l = [];					for (j = 0; j < 4; j++)						l[j] = N[(F(i) * I + a[j]) % L];					t *= i == s ? 1 - b : i == s + 7 ? b : 1;					c += ( ((1 - u) * l[0] + u * l[1]) * (1 - v) + ((1 - u) * l[3] + u * l[2]) * v ) * t;					q += t				};				c = E(M.abs(c / q * 2 - 1), 1.5);				return y < 400 ? c * y / 399 : c			}			// contour			function D()			{				d = 4 + z / I;				for (x = 0; x < w; x++)				{					o = C(P = (x - w/2) * d + w, z);					y = h - o * 2200 / (d + 20) - (d - 6) * 5;					if (x)					{						H = C(P + d, z) - o;						$ = C(P, z + d) - o;						m = M.sqrt(H * H + 9/J + $ * $);						l = 1 - M.max(0, H / m * .1 + $ / m * .9);						for (i=0, c=[], b = z / L / 2.1; i<3; i++)						{							c[i] =								(1 - b) * (l + o) / 5 +								b * B()[i];						}												A(x-1,ly,x,y,c);					}					ly = y;				}				z -= d;				if (z > 0)					setTimeout(D, 1);			}			M = Math;			E = M.pow;			F = M.floor;			I = 1000;			J = I * I;			L = 9 * I;			N = [];			for (i = 0; i < L; N[i++] = M.random());			with (document.getElementById('c'))			{				width = w = I;				height = h = 255;				G = getContext('2d')			};			for (y = 0; y < h; A(0,y,w,y++,B()));			z = L * 2.1;			D()		</script>			</body></html>	