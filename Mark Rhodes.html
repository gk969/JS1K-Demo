<html>	<head>		<title>JS1K Demo</title>		<meta charset="utf-8">	</head>		<body>		<canvas id="c" width="1024" height="768">		<script>			var b = document.body;			var c = document.getElementsByTagName('canvas')[0];			var a = c.getContext('2d');			document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218		</script>				<script>			var bugs=[],s=16,M=Math,t=c=O=K=E=y=0,D=1,i,n,img,r,dest,head,luckyNumbers,tail,numBugs=1200,h=300,f=150,c={},luckyNumbers=[];			rand=M.random,round=M.round,P=M.PI,floor=M.floor,startStr='rgb(';			with(document.body.children.c)width=height=h,x=getContext('2d');			x.font = '200px Times';			setInterval(function(){				//get lottery numbers, in number and image form..				n = round(rand()*48)+1;				if(y<6 & !(n in c)){					x.fillStyle=startStr+'2,0,0)';					x.fillText(n, f-x.measureText(n).width/2,257);					img = x.getImageData(0,0,h,h).data;					dest = [];					for(i=0;i<img.length;i+=4){						if(img[i] == 2 & rand() > .9)							dest.push([(i/4) % h, floor(i/1600)]);					}					luckyNumbers.push([n, dest]);					c[''+n]=1;					y++;				}				//reset the canvas..				x.fillStyle=startStr+'200,200,200)';				x.fillRect(0,0,h,h);								x.fillStyle=startStr+'1,0,0)';				dest = luckyNumbers[K][1];				for(n = 0; n < numBugs; n++){					if(!E) bugs.push([{							 x: f,							 y: f,							 angle:floor(rand()*s)						},{x:f,y:f}]);									//draw the bug..					head = bugs[n][0];					tail = bugs[n][1];					//set dest to be the correct thing..					r=dest[n%dest.length]					head.destX = r[0];					head.destY = r[1];										x.beginPath();					x.moveTo(head.x, head.y);					x.lineTo(tail.x, tail.y);					x.stroke();					//update it's position..					tail.x = head.x;					tail.y = head.y;					r=head.angle*P/8;					head.x += M.sin(r) * 2;					head.y -= M.cos(r) * 2;					//update angle/operation..					//only change if with low prop..					if(D){						r = round(8*M.atan((head.x-head.destX)/(head.destY-head.y))/P);						r += (head.y < head.destY) ? 24: s;						r%=s;						//turn towards the desired angle..						if(r == head.angle){							head.op = 1;						} else if(rand() > .8){							if(r < head.angle) r+=s;							head.op = (r - head.angle < 8) ? 2 : 0;						}					} else {						r = rand();						head.op = (r < 0.3) ? 0 : (r < 0.6) ? 2 : 1;					}					head.angle +=(!head.op)?15:(head.op==2)? 17 : s;					head.angle %= s;				}				if(++E>100){					if(t%3){						D=!D;						if(t%2){							K++;							K %= 6;						}					}					t++;					D!=D					E=0;				}			},20);		</script>			</body></html>	