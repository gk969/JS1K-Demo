<html>
	<head>
		<title>JS1K Demo</title>
		<meta charset="utf-8">
	</head>
	
	<body>
		<canvas id="c" width="1024" height="768">
		<script>
     
      var a = document.getElementsByTagName('canvas')[0];
      var b = document.body;
      // unprefix some popular vendor prefixed things (but stick to their original name)
      var AudioContext =
        window.AudioContext ||
          window.webkitAudioContext;
      var requestAnimationFrame =
        window.requestAnimationFrame ||
          window.mozRequestAnimationFrame ||
          window.webkitRequestAnimationFrame ||
          window.msRequestAnimationFrame ||
          function(f){ setTimeout(f, 1000/30); };
      // stretch canvas to screen size (once, wont onresize!)
      a.style.width = (a.width = innerWidth) + 'px';
      a.style.height = (a.height = innerHeight) + 'px';

      var g = (function () {
        try {
          var o = { antialias: true, stencil: true };
          var gl = c.getContext('webgl', o) || c.getContext('experimental-webgl', o);

          // keep in scope, must not be garbage collected
          __glExts =
            [ 'OES_texture_float', 'OES_texture_float_linear', 'OES_standard_derivatives',
              'EXT_texture_filter_anisotropic', 'MOZ_EXT_texture_filter_anisotropic', 'WEBKIT_EXT_texture_filter_anisotropic',
              'WEBGL_compressed_texture_s3tc', 'MOZ_WEBGL_compressed_texture_s3tc', 'WEBKIT_WEBGL_compressed_texture_s3tc'
            ].map(function (ext) {
              return gl.getExtension(ext);
            });

        } catch (e) {
          document.body.innerHTML = 'WebGL not supported.';
          throw e;
        }

        return gl;
      })();
    
		</script>
		
		<script>

      if (!g) throw there_was_a_webgl_error;
      // start of submission //
w = a.width /= 3, h = a.height /= 3;
for (i in g) g[i[1] + i[7] + i[i.length - 1]] = g[i];
with(g) {
    for (ifr(RUR, rur()), uaa(RUR, new Float32Array([-1, -1, -1, 9, 9, -1]), 35044), p = rrm(), t = 0; s = rhr(ESR - t); oSr(s), thr(p, s)) hoe(s, t++ ? "#ifdef GL_ES\nprecision highp float;\n#endif\nuniform float t;float a(vec3 b,float o){float c=.0,j;for(float j=.8;j<6.;j+=.7){c+=sin(b.x*j*j*2.)*cos(b.z*j*j-o)*.7/pow(j,2.5);b.xz=mat2(1.,-.4,.4,1.)*b.xz;}return c;}void main(void){float n=.5+sin(t)*.1,l=0.,d=l;vec3 p=vec3(l,-1.,-t),c=-normalize(gl_FragCoord.xyz/vec3(" + w + "," + h + ",.5)-n);for(float i=0.;i<70.;i++){n=a(p,0.)-p.y;d+=n;p+=c*n*.4;l++;if(n<.05||d>60.) break;}l=1.-l/60.;n=max(.5-p.y,0.);gl_FragColor=vec4(mix(((a(p,1.6)+2.)*.1+l)*vec3(mix(.4,.0,min(1.,n*abs(a(p*.5,0.))+.7)))+min(1.,pow(a(p*2.,0.)*n,2.))*l,vec3(.9,.9,1.)+c.y*1.5,pow(min(d*.02,1.),2.)),1.);}" : "attribute vec2 p;void main(){gl_Position=vec4(p,.5,1.);}");
    igm(p), srm(p), etr(0, 2, 5126, 0, 0, 0), ney(0), s = +new Date, (l = function() {
        ras(RES, 0, 3), n1f(eon(p, "t"), .001 * (+new Date - s)), requestAnimationFrame(l)
    })()
}
      // end of submission //
    
		</script>
		
	</body>
</html>
	